<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build with ChatGPT on your phone</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Wordle Colors */
        .wordle-green { background-color: #6aaa64; color: white; }
        .wordle-yellow { background-color: #c9b458; color: white; }
        .wordle-gray { background-color: #787c7e; color: white; }
        .wordle-bg { background-color: #121212; }

        /* Custom Font and Styling */
        body { 
            font-family: 'Inter', sans-serif; 
            position: relative; /* Needed for ::before positioning */
        }
        
        /* Faded Grid Background (New Feature) */
        .wordle-bg::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Adjusted grid line color for better visibility */
            opacity: 0.15; /* Slightly increased opacity */
            background-image: linear-gradient(to right, #4a4a4a 1px, transparent 1px),
                              linear-gradient(to bottom, #4a4a4a 1px, transparent 1px);
            background-size: 20px 20px;
            pointer-events: none; /* Allows interaction with content below */
            z-index: 0;
        }

        .slide-container {
            /* Adjusted min-height for a better landscape fill (70vh is approximately 16:9 when the width is near 90% of a typical screen) */
            min-height: 70vh; 
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .tracker-tile {
            width: 1.8rem;
            height: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
            border-radius: 4px;
            margin: 0 2px;
            transition: all 0.3s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Custom Box Classes for Demonstration */
        .demo-box {
            padding: 1rem 2rem;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 700;
            min-height: 100px;
        }
        .demo-red { background-color: #b91c1c; border: 4px solid #ef4444; } /* Red */
        .demo-blue { background-color: #2563eb; border: 4px solid #3b82f6; } /* Blue */
        .demo-purple { background-color: #9333ea; border: 4px solid #a855f7; } /* Purple */


        /* Ensure content is above the grid background */
        .presentation-card {
            z-index: 10;
            position: relative; 
        }

        /* Responsive adjustments for mobile/smaller screens */
        @media (min-width: 640px) {
            .tracker-tile {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1.5rem;
            }
        }

        /* Wordle Animations */
        @keyframes flip-in {
            0% { transform: scale(0) rotateX(-90deg); opacity: 0; }
            100% { transform: scale(1) rotateX(0deg); opacity: 1; }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-7px); }
        }

        .animated-tile {
            animation-name: flip-in;
            animation-duration: 0.5s;
            animation-fill-mode: both;
        }

        .bounce-animation {
            animation-name: bounce !important;
            animation-duration: 1s;
            animation-iteration-count: 1;
        }
        
        /* Terminal Snark Overlay */
        .snark-overlay {
            position: fixed;
            bottom: 20px;
            left: 20px;
            right: 20px;
            width: calc(100vw - 40px);
            min-height: 80px;
            max-height: 200px;
            background: #000;
            border: 2px solid #00ff00;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            color: #00ff00;
            font-size: 14px;
            padding: 16px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            z-index: 9999;
            opacity: 0;
            transform: translateX(-50px);
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            overflow-y: auto;
        }
        
        .snark-overlay.active {
            opacity: 1;
            transform: translateX(0);
        }
        
        .snark-line {
            display: block;
            margin: 0;
            white-space: nowrap;
            font-family: 'Courier New', monospace;
            color: #00ff00;
            line-height: 1.4;
            margin-bottom: 2px;
            position: relative;
        }
        
        .snark-line.large {
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .snark-line.typing::after {
            content: '';
            display: inline-block;
            background-color: #00ff00;
            width: 2px;
            height: 1em;
            margin-left: 2px;
            animation: blink 1s infinite;
        }
        
        .snark-cursor {
            display: none; /* Hide the static cursor when typing */
        }
        
        .snark-cursor.show {
            display: inline-block;
            background-color: #00ff00;
            width: 2px;
            height: 1em;
            margin-left: 2px;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Glitch effect for meta-workflow */
        @keyframes glitch {
            0% { 
                transform: translateX(0);
                filter: hue-rotate(0deg);
            }
            10% { 
                transform: translateX(-2px);
                filter: hue-rotate(90deg);
            }
            20% { 
                transform: translateX(2px);
                filter: hue-rotate(180deg);
            }
            30% { 
                transform: translateX(-1px);
                filter: hue-rotate(270deg);
            }
            40% { 
                transform: translateX(1px);
                filter: hue-rotate(360deg);
            }
            50% { 
                transform: translateX(-2px);
                background-color: #ff0000;
                border-color: #ff0000;
                color: #ffffff;
            }
            60% { 
                transform: translateX(2px);
                background-color: #ff0000;
                border-color: #ff0000;
                color: #ffffff;
            }
            70% { 
                transform: translateX(-1px);
                background-color: #ff0000;
                border-color: #ff0000;
                color: #ffffff;
            }
            80% { 
                transform: translateX(1px);
                background-color: #ff0000;
                border-color: #ff0000;
                color: #ffffff;
            }
            90% { 
                transform: translateX(0);
                background-color: #ff0000;
                border-color: #ff0000;
                color: #ffffff;
                opacity: 1;
            }
            100% { 
                transform: translateX(0);
                background-color: #ff0000;
                border-color: #ff0000;
                color: #ffffff;
                opacity: 0;
            }
        }
        
        .snark-overlay.glitching {
            animation: glitch 2s ease-in-out forwards;
        }
        
        .snark-overlay.glitching .snark-line {
            color: #ffffff;
        }
        
        .snark-overlay::before {
            content: '> ';
            color: #00ff00;
            font-weight: bold;
            position: absolute;
            top: 16px;
            left: 16px;
        }
        
        .snark-content {
            margin-left: 20px; /* Offset for the prompt */
        }

        /* Styling for Do's and Don'ts Slide */
        .do-list, .dont-list {
            list-style: none;
            padding-left: 0;
            margin-top: 1rem;
        }
        .do-list li {
            background-color: #16a34a20; /* Green accent */
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            border-left: 4px solid #4ade80;
            text-align: left;
        }
        .dont-list li {
            background-color: #dc262620; /* Red accent */
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            border-left: 4px solid #f87171;
            text-align: left;
        }
        
        /* Utility for the blank start screen */
        .h-blank-start {
            min-height: 50vh; /* Ensure the height remains consistent */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Icon styling */
        .start-icon {
            border: 4px solid;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .start-icon:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(109, 233, 109, 0.5); /* Subtle glow on hover */
        }
        
        /* Propaganda overlay styles */
        .propaganda-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(220, 38, 38, 0.85); /* Red overlay with transparency */
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            pointer-events: none;
        }
        
        .propaganda-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .propaganda-text {
            font-size: 6rem;
            font-weight: 900;
            color: white;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.7);
            animation: propagandaPulse 2s infinite;
            letter-spacing: 0.2em;
        }
        
        @keyframes propagandaPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'wordle-dark': '#121212',
                        'wordle-light': '#ffffff',
                    }
                }
            }
        }
    </script>
    <!-- Import shared slides data -->
    <script src="slides-data.js"></script>
</head>
<body class="wordle-bg text-wordle-light min-h-screen p-4 md:p-8">

    <!-- Propaganda Overlay (hidden by default) -->
    <div id="propaganda-overlay" class="propaganda-overlay">
        <div class="propaganda-text">PROPAGANDA</div>
    </div>

    <!-- Snark Overlay (hidden by default) -->
    <div id="snark-overlay" class="snark-overlay">
        <div class="snark-content" id="snark-content">
            <span class="snark-cursor" id="snark-cursor"></span>
        </div>
    </div>

    <div class="presentation-card w-11/12 max-w-7xl mx-auto bg-gray-900 shadow-2xl rounded-xl p-6 md:p-16">
        <!-- Presentation Title Bar -->
        <header class="mb-6 border-b border-gray-700 pb-4">
            <h1 class="text-3xl font-extrabold text-green-400">Couch Developer</h1>
            <p class="text-sm text-gray-400">Gordon Keenan â€” 2025 | Slide <span id="slide-number">1</span> of 21</p>
        </header>

        <!-- Slide Content Area -->
        <div id="slide-content" class="slide-container">
            <!-- Content will be injected here -->
        </div>

        <!-- Speaker Notes and Navigation -->
        <footer class="mt-8 pt-4 border-t border-gray-700">
            <!--
                The speaker notes <ul> element is kept hidden to prevent the JS error while
                ensuring the code can still access the element.
            -->
            <ul id="speaker-notes" class="hidden">
                <!-- Notes content is inserted here by JS but remains hidden -->
            </ul>

            <!-- Navigation remains visible -->
            <div class="flex justify-between space-x-4">
                <button id="prev-btn" onclick="navigateSlide(-1)"
                    class="px-4 py-2 bg-gray-700 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600 transition disabled:opacity-50 disabled:cursor-not-allowed">
                    Previous
                </button>
                <button id="next-btn" onclick="navigateSlide(1)"
                    class="px-4 py-2 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-600 transition disabled:opacity-50 disabled:cursor-not-allowed">
                    Next
                </button>
            </div>
        </footer>
    </div>

    <script>
        // --- BASE64 IMAGE SOURCE ---
        // Using the Base64 ID for the latest uploaded image to ensure it loads in the iFrame/Browser environment.
        const COUCH_IMAGE_SRC = "IMG_5384.jpg"; 

        let currentSlideIndex = 0;
        let isPresentationStarted = false; // New state to control initial animation and visibility

        // Use shared slides-data.js to load the full presentation slides
        const slides = (typeof getSlides === 'function') ? getSlides('full') : [];

        function getTileColor(letter, index, word) {
            // Simple coloring logic for visual appeal based on position (for non-final slides)
            if (index === 0 || index === 4) return 'wordle-green';
            if (index === 1 || index === 3) return 'wordle-yellow';
            return 'wordle-gray';
        }

        function renderTracker(word, slideIndex) {
            const isFinalSlide = slideIndex === 20; // Slide 21 is index 20
            const isPurpleSlide = slideIndex === 5; // Slide 6 is index 5 (PAST tracker)
            const isBlueSlide = slideIndex === 4; // Slide 5 is index 4 (VALID tracker)
            const isInvalidSlide = word === "INVALID"; // INVALID tracker gets red outline

            // Handle array of trackers (for slide 5)
            if (Array.isArray(word)) {
                const trackerRows = word.map((trackerWord, trackerIndex) => {
                    const trackerHtml = Array.from(trackerWord).map((letter, letterIndex) => {
                        const colorClass = isFinalSlide ? 'wordle-green' : getTileColor(letter, letterIndex, trackerWord);
                        
                        let outline = '';
                        if (isPurpleSlide) {
                            outline = 'border-2 border-purple-500';
                        } else if (isBlueSlide && trackerWord === "VALID") {
                            outline = 'border-2 border-blue-500';
                        } else if (trackerWord === "INVALID") {
                            outline = 'border-2 border-red-500';
                        }
                        
                        const delay = (trackerIndex * trackerWord.length + letterIndex) * 0.1;
                        let animationClass = '';

                        if (slideIndex === 0) {
                            if (isPresentationStarted) {
                                animationClass = 'animated-tile';
                            }
                        } else {
                            animationClass = 'animated-tile';
                        }

                        return `<div class="tracker-tile ${colorClass} ${animationClass} ${outline}" style="animation-delay: ${delay}s;">${letter}</div>`;
                    }).join('');
                    
                    return `<div class="flex justify-center">${trackerHtml}</div>`;
                }).join('');
                
                return `<div class="grid grid-rows-2 gap-8 justify-items-center">${trackerRows}</div>`;
            }

            return Array.from(word).map((letter, index) => {
                // If it's the final slide, force all tiles to be green as requested.
                const colorClass = isFinalSlide ? 'wordle-green' : getTileColor(letter, index, word);
                
                // Add outlines for specific slides/trackers
                let outline = '';
                if (isPurpleSlide) {
                    outline = 'border-2 border-purple-500';
                } else if (isBlueSlide) {
                    outline = 'border-2 border-blue-500';
                } else if (isInvalidSlide) {
                    outline = 'border-2 border-red-500';
                }
                
                const delay = index * 0.1;
                let animationClass = ''; // Start empty

                // Logic to control animation based on presentation start state
                if (slideIndex === 0) {
                    if (isPresentationStarted) {
                        animationClass = 'animated-tile';
                    }
                } else if (isFinalSlide) {
                    // Logic for final slide bounce animation
                    animationClass = 'animated-tile bounce-animation';
                    return `<div class="tracker-tile ${colorClass} ${animationClass} ${outline}" style="animation-delay: ${delay}s; animation-iteration-count: infinite;">${letter}</div>`;
                } else {
                    // Logic for all other slides: animation runs on load (navigation)
                    animationClass = 'animated-tile';
                }

                return `<div class="tracker-tile ${colorClass} ${animationClass} ${outline}" style="animation-delay: ${delay}s;">${letter}</div>`;
            }).join('');
        }

        function startPresentation() {
            if (currentSlideIndex === 0 && !isPresentationStarted) {
                isPresentationStarted = true;
                // Transition from Blank Screen to Full Content (with animation)
                renderSlide(0); 
            }
        }

        function renderSlide(index) {
            const slide = slides[index];
            const contentDiv = document.getElementById('slide-content');
            const notesList = document.getElementById('speaker-notes'); 
            const slideNumSpan = document.getElementById('slide-number');
            const header = document.querySelector('header');

            // Clear any existing snark overlay
            const snarkOverlay = document.getElementById('snark-overlay');
            if (snarkOverlay) {
                snarkOverlay.classList.remove('active');
                const snarkContent = document.getElementById('snark-content');
                snarkContent.innerHTML = '<span class="snark-cursor" id="snark-cursor"></span>';
                // Clear any ongoing typing intervals
                if (window.snarkTypeInterval) {
                    clearInterval(window.snarkTypeInterval);
                    window.snarkTypeInterval = null;
                }
            }

            // Update UI State
            slideNumSpan.textContent = index + 1;
            document.getElementById('prev-btn').disabled = index === 0;
            document.getElementById('next-btn').disabled = index === slides.length - 1;
            currentSlideIndex = index;

            // --- Logic for Blank Start Screen (Slide 1) ---
            if (index === 0 && !isPresentationStarted) {
                // Phase 1: Blank Screen with Icon/Button
                
                // Hide the main header elements for a truly blank start
                header.querySelector('h1').style.opacity = 0;
                header.querySelector('p').style.opacity = 0;
                header.style.borderBottom = 'none';

                // Hide the footer and navigation buttons
                const footer = document.querySelector('footer');
                footer.style.display = 'none';

                contentDiv.innerHTML = `
                    <div class="h-blank-start w-full text-center flex flex-col items-center justify-center">
                        <div id="start-button" onclick="startPresentation()"
                             class="start-icon w-[35.8rem] h-[35.8rem] bg-transparent border-green-500 border-4 rounded-full flex items-center justify-center 
                                    text-white shadow-2xl transition-all duration-300 overflow-hidden">
                            <img src="${COUCH_IMAGE_SRC}" alt="Couch Coder (AI Development)" 
                                 class="w-full h-full object-cover">
                        </div>
                        <p class="mt-6 text-gray-400 text-4xl text-center">The trials and tribulations of being a couch developer</p>
                    </div>
                `;
                return;

            } else {
                // Phase 2: Full Content Render (all other slides, or Slide 1 after start)
                
                // Show the main header elements
                header.querySelector('h1').style.opacity = 1;
                header.querySelector('p').style.opacity = 1;
                header.style.borderBottom = '1px solid rgb(55 65 81)'; // Restore border-gray-700

                // Show the footer and navigation buttons
                const footer = document.querySelector('footer');
                footer.style.display = 'block';

                // Slide Title and Tracker
                contentDiv.innerHTML = `
                    <div class="flex flex-col items-center mb-10">
                        <h2 class="text-4xl md:text-5xl font-bold text-center text-white mb-6 leading-tight">${slide.title}</h2>
                        <div class="flex justify-center" id="tracker-display">${renderTracker(slide.tracker, index)}</div>
                    </div>
                    <div class="flex-grow text-center">
                        ${slide.content}
                    </div>
                `;
                
                // Re-enable navigation if not on the first slide
                document.getElementById('prev-btn').disabled = index === 0;
            }
            // Notes are updated in the background
            notesList.innerHTML = slide.notes.map(note => `<li>${note}</li>`).join('');
            
            // Check if this slide has snark and trigger it after 3 seconds
            if (slide.snark) {
                setTimeout(() => {
                    showSnarkOverlay(slide.snark);
                }, 3000);
            }
        }

        function showSnarkOverlay(snarkText, isLarge = false) {
            const overlay = document.getElementById('snark-overlay');
            const contentElement = document.getElementById('snark-content');
            const staticCursor = document.getElementById('snark-cursor');
            
            // Clear any existing typing interval
            if (window.snarkTypeInterval) {
                clearInterval(window.snarkTypeInterval);
                window.snarkTypeInterval = null;
            }
            
            // Split text into lines (support for \n or array of lines)
            let lines = [];
            if (Array.isArray(snarkText)) {
                lines = snarkText;
            } else {
                lines = snarkText.split('\n');
            }
            
            // Check if this is the meta-workflow slide for special glitch effect
            const isMetaWorkflow = Array.isArray(snarkText) && 
                                 snarkText.some(line => line.includes('half crazy'));
            
            // Reset and show overlay
            contentElement.innerHTML = '<span class="snark-cursor" id="snark-cursor"></span>';
            overlay.classList.remove('glitching'); // Remove any previous glitch class
            overlay.classList.add('active');
            staticCursor.classList.remove('show'); // Hide static cursor during typing
            
            let currentLineIndex = 0;
            let currentCharIndex = 0;
            let currentLineElement = null;
            let pauseCounter = 0;
            
            window.snarkTypeInterval = setInterval(() => {
                // Handle pause between lines
                if (pauseCounter > 0) {
                    pauseCounter--;
                    return;
                }
                
                // If we've finished all lines, stop and show static cursor
                if (currentLineIndex >= lines.length) {
                    clearInterval(window.snarkTypeInterval);
                    window.snarkTypeInterval = null;
                    
                    // Remove typing cursor from last line
                    if (currentLineElement) {
                        currentLineElement.classList.remove('typing');
                    }
                    
                    // Special glitch effect for meta-workflow
                    if (isMetaWorkflow) {
                        setTimeout(() => {
                            overlay.classList.add('glitching');
                            // Remove overlay completely after glitch animation
                            setTimeout(() => {
                                overlay.classList.remove('active', 'glitching');
                            }, 2000);
                        }, 1000); // Wait 1 second after typing completes
                    } else {
                        staticCursor.classList.add('show');
                    }
                    return;
                }
                
                // If starting a new line, create the line element
                if (currentCharIndex === 0) {
                    // Remove typing cursor from previous line
                    if (currentLineElement) {
                        currentLineElement.classList.remove('typing');
                    }
                    
                    currentLineElement = document.createElement('div');
                    currentLineElement.className = 'snark-line' + (isLarge ? ' large' : '') + ' typing';
                    currentLineElement.textContent = '';
                    contentElement.insertBefore(currentLineElement, document.getElementById('snark-cursor'));
                }
                
                const currentLine = lines[currentLineIndex];
                
                // If we've finished the current line
                if (currentCharIndex >= currentLine.length) {
                    currentLineIndex++;
                    currentCharIndex = 0;
                    pauseCounter = 7; // Pause for 7 intervals between lines
                    return;
                }
                
                // Add the next character
                currentLineElement.textContent += currentLine[currentCharIndex];
                currentCharIndex++;
                
            }, isLarge ? 20 : 30);
        }

        function navigateSlide(direction) {
            const newIndex = currentSlideIndex + direction;
            if (newIndex >= 0 && newIndex < slides.length) {
                renderSlide(newIndex);
            }
        }

        // Global Keydown Listener for Arrow Keys and Spacebar
        document.addEventListener('keydown', (event) => {
            if (event.code === 'Space') {
                event.preventDefault(); // Prevent spacebar from scrolling the page
                
                console.log('Spacebar pressed, currentSlideIndex:', currentSlideIndex, 'Slide title:', slides[currentSlideIndex]?.title);
                
                // Special behavior for propaganda overlay slide  
                const propagandaSlideIndex = (typeof getPropagandaSlideIndex === 'function') ? getPropagandaSlideIndex('full') : -1;
                if (currentSlideIndex === propagandaSlideIndex) {
                    console.log('Triggering propaganda overlay for slide at index:', propagandaSlideIndex);
                    const overlay = document.getElementById('propaganda-overlay');
                    overlay.classList.add('active');
                    
                    // Show special snark message when propaganda appears
                    setTimeout(() => {
                        showSnarkOverlay([
                            "// ALERT!",
                            "// Activating counter-narrative protocol...",
                            "// Pay no attention to the man behind the curtain!"
                        ], true);
                    }, 500);
                    
                    // Hide overlay after 3 seconds
                    setTimeout(() => {
                        overlay.classList.remove('active');
                    }, 3000);
                    return; // Don't advance slide on this specific slide
                }
                
                // Handle presentation start only
                if (currentSlideIndex === 0 && !isPresentationStarted) {
                    startPresentation();
                    return;
                }
                
                // Remove normal slide advancement with spacebar - only arrows now
            } else if (event.key === 'ArrowRight') {
                navigateSlide(1);
            } else if (event.key === 'ArrowLeft') {
                navigateSlide(-1);
            }
        });

        // Initialize presentation on load
        document.addEventListener('DOMContentLoaded', () => {
            // Render the initial blank state
            renderSlide(0);
        });
    </script>
</body>
</html>
